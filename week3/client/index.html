<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SocketIO Server</title>
    <script src="https://cdn.socket.io/socket.io-3.0.1.min.js"></script>


</head>

<body>
    <h1>Welcome to socketIO Server</h1>
    <br>
    <canvas id="canvas" width="800" height="600" style="border:1px solid black"></canvas>


    <!--<button onclick="msg()">Send</button>-->
    <script>
        var socket = io()
        var canvas = document.getElementById("canvas")
        var ctx = canvas.getContext("2d")
        ctx.font = "30px Arial"

        //event listeners for keypressed
        document.addEventListener('keydown', keyPressDown)
        document.addEventListener('keyup', keyPressUp)

        function keyPressDown(e) {
            if (e.keyCode === 38)//up
                socket.emit('keypress', { inputId: 'up', state: true })
            else if (e.keyCode === 40)//down
                socket.emit('keypress', { inputId: 'down', state: true })
            else if (e.keyCode === 37)//left
                socket.emit('keypress', { inputId: 'left', state: true })
            else if (e.keyCode === 39)//right
                socket.emit('keypress', { inputId: 'right', state: true })

        }

        function keyPressUp(e) {
            if (e.keyCode === 38)//up
                socket.emit('keypress', { inputId: 'up', state: false })
            else if (e.keyCode === 40)//down
                socket.emit('keypress', { inputId: 'down', state: false })
            else if (e.keyCode === 37)//left
                socket.emit('keypress', { inputId: 'left', state: false })
            else if (e.keyCode === 39)//right
                socket.emit('keypress', { inputId: 'right', state: false })
        }


        socket.on('newPositions', function (data) {
            ctx.clearRect(0, 0, canvas.width, canvas.height)
            for (var i = 0; i < data.length; i++) {
                ctx.fillText(data[i].number, data[i].x, data[i].y)
            }
        })

        /// example code from wednesday 1/27
        // var msg = function()
        // {
        //     socket.emit('sendBtnMsg',
        //     {
        //         message:'Sending Messge from button'
        //     })
        // }

        // socket.emit('sendMsg',
        // {
        //     message:'Hello Ryan I am logged in'
        // })

        // socket.on('messageFromServer', function(data)
        // {
        //     console.log(data.message)
        // })

    </script>
</body>

</html>